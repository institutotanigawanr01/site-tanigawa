<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerar Contrato - Instituto Tanigawa</title>
    <meta name="description" content="Geração de contrato de mentoria - Instituto Tanigawa">
    
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-tertiary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --color-dark: #0a0e27;
            --color-darker: #060919;
            --color-card: rgba(255, 255, 255, 0.03);
            --color-card-strong: rgba(6, 9, 25, 0.96);
            --color-text: #ffffff;
            --color-text-muted: #a0aec0;
            --shadow-card: 0 20px 60px rgba(0, 0, 0, 0.6);
            --shadow-soft: 0 10px 30px rgba(15, 23, 42, 0.55);
        }

        body {
            font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background-color: var(--color-dark);
            color: var(--color-text);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(245, 87, 108, 0.09) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(67, 233, 123, 0.08) 0%, transparent 50%);
            z-index: -1;
            animation: backgroundShift 26s infinite alternate ease-in-out;
            pointer-events: none;
        }

        @keyframes backgroundShift {
            from { transform: translate3d(0,0,0); }
            to   { transform: translate3d(40px,60px,0); }
        }

        header {
            position: sticky;
            top: 0;
            z-index: 20;
            backdrop-filter: blur(18px);
            background: linear-gradient(135deg, rgba(10,14,39,0.96), rgba(6,9,25,0.98));
            border-bottom: 1px solid rgba(255,255,255,0.06);
            box-shadow: 0 16px 40px rgba(0,0,0,0.75);
        }

        nav {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0.9rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            border-radius: 14px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: "Sora", system-ui, sans-serif;
            font-weight: 700;
            font-size: 1.05rem;
            color: #fff;
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.65);
        }

        .logo-text span {
            display: block;
        }

        .logo-small {
            font-size: 0.73rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--color-text-muted);
        }

        .logo-main {
            font-family: "Sora", system-ui, sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-badge {
            padding: 0.35rem 0.9rem;
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,0.15);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.13em;
            color: var(--color-text-muted);
        }

        .nav-btn {
            padding: 0.6rem 1.5rem;
            border-radius: 999px;
            border: none;
            background: var(--gradient-secondary);
            color: #fff;
            font-family: "Sora", system-ui, sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            box-shadow: 0 12px 28px rgba(245, 87, 108, 0.75);
            transition: 0.25s;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 16px 36px rgba(245, 87, 108, 0.9);
        }

        main {
            max-width: 1100px;
            margin: 2.5rem auto 3rem;
            padding: 0 2rem 3rem;
        }

        .page-title {
            font-family: "Sora", system-ui, sans-serif;
            font-size: 1.9rem;
            margin-bottom: 0.25rem;
        }

        .page-subtitle {
            font-size: 0.95rem;
            color: var(--color-text-muted);
            margin-bottom: 1.8rem;
        }

        .grid {
            display: grid;
            grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.1fr);
            gap: 1.8rem;
        }

        .card {
            background: var(--color-card-strong);
            border-radius: 24px;
            padding: 1.6rem 1.6rem 1.9rem;
            border: 1px solid rgba(255,255,255,0.06);
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top left, rgba(102,126,234,0.35), transparent 55%);
            opacity: 0;
            transition: opacity 0.25s;
        }

        .card:hover::before {
            opacity: 1;
        }

        .card-title {
            font-family: "Sora", system-ui, sans-serif;
            font-size: 1.1rem;
            margin-bottom: 0.4rem;
        }

        .card-subtitle {
            font-size: 0.9rem;
            color: var(--color-text-muted);
            margin-bottom: 1.1rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 1rem 1.2rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
        }

        label {
            font-size: 0.8rem;
            color: var(--color-text-muted);
        }

        input, select, textarea {
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,0.16);
            background: rgba(6,9,25,0.96);
            color: var(--color-text);
            padding: 0.7rem 1rem;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.25s, box-shadow 0.25s, background 0.25s;
            font-family: inherit;
        }

        textarea {
            border-radius: 18px;
            min-height: 130px;
            resize: vertical;
        }

        input:focus, select:focus, textarea:focus {
            border-color: rgba(102,126,234,0.9);
            box-shadow: 0 0 0 1px rgba(102,126,234,0.7);
            background: rgba(4,7,20,0.98);
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .btn-row {
            margin-top: 1.4rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
        }

        .btn-primary {
            border-radius: 999px;
            padding: 0.85rem 1.8rem;
            border: none;
            background: var(--gradient-tertiary);
            color: #fff;
            font-family: "Sora", system-ui, sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 24px rgba(79,172,254,0.8);
            transition: 0.25s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 14px 30px rgba(79,172,254,0.95);
        }

        .btn-secondary {
            border-radius: 999px;
            padding: 0.8rem 1.7rem;
            border: 1px solid rgba(255,255,255,0.2);
            background: transparent;
            color: var(--color-text-muted);
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.25s;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.05);
            color: #fff;
        }

        .status {
            margin-top: 0.8rem;
            font-size: 0.85rem;
            color: var(--color-text-muted);
        }

        /* Contrato */
        .contract {
            background: #ffffff;
            color: #111827;
            border-radius: 18px;
            padding: 1.5rem 1.6rem;
            max-height: 680px;
            overflow-y: auto;
            font-size: 0.9rem;
            box-shadow: 0 14px 40px rgba(15,23,42,0.7);
        }

        .contract h2 {
            font-family: "Sora", system-ui, sans-serif;
            font-size: 1.1rem;
            margin-bottom: 0.6rem;
        }

        .contract h3 {
            font-size: 0.95rem;
            margin-top: 1.4rem;
            margin-bottom: 0.4rem;
        }

        .contract p {
            margin-bottom: 0.4rem;
            text-align: justify;
        }

        .contract strong {
            font-weight: 600;
        }

        .contract .signature {
            margin-top: 1.8rem;
        }

        .contract .signature p {
            margin-bottom: 1.2rem;
        }

        .contract hr {
            border: none;
            border-top: 1px solid #e5e7eb;
            margin: 0.6rem 0 1rem;
        }

        @media (max-width: 960px) {
            .grid {
                grid-template-columns: minmax(0,1fr);
            }
            main {
                padding: 0 1.2rem 2.4rem;
            }
            nav {
                padding: 0.9rem 1.2rem;
            }
        }

        @media print {
            body {
                background: #ffffff;
            }

            header, .btn-row, .status {
                display: none !important;
            }

            main {
                max-width: 100%;
                margin: 0;
                padding: 0;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .card {
                box-shadow: none;
                border-radius: 0;
                border: none;
            }

            .contract {
                box-shadow: none;
                border-radius: 0;
                max-height: none;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="admin_dashboard.html" class="logo">
                <div class="logo-icon">IT</div>
                <div class="logo-text">
                    <span class="logo-small">Painel de Governo</span>
                    <span class="logo-main">Admin • Instituto Tanigawa</span>
                </div>
            </a>
            <div class="nav-right">
                <span class="nav-badge">Gerador de Contratos</span>
                <button class="nav-btn" type="button" onclick="goBack()">Voltar ao painel</button>
            </div>
        </nav>
    </header>

    <main>
        <h1 class="page-title">Gerar contrato de mentoria</h1>
        <p class="page-subtitle">
            Preencha os dados do mentorado e da mentoria para gerar o contrato personalizado.
        </p>

        <section class="grid">
            <article class="card">
                <h2 class="card-title">Dados do contrato</h2>
                <p class="card-subtitle">Revise com atenção antes de gerar o documento final.</p>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="nomeMentorado">Nome completo do mentorado</label>
                        <input type="text" id="nomeMentorado" placeholder="Nome do mentorado" />
                    </div>
                    <div class="form-group">
                        <label for="cpfMentorado">CPF</label>
                        <input type="text" id="cpfMentorado" placeholder="000.000.000-00" />
                    </div>
                    <div class="form-group">
                        <label for="cidadeMentorado">Cidade / Estado</label>
                        <input type="text" id="cidadeMentorado" placeholder="Cidade - UF" />
                    </div>
                    <div class="form-group">
                        <label for="dataContrato">Data do contrato</label>
                        <input type="date" id="dataContrato" />
                    </div>
                    <div class="form-group">
                        <label for="nomeMentoria">Mentoria / Programa</label>
                        <input type="text" id="nomeMentoria" placeholder="Ex.: Mentoria Synesis" />
                    </div>
                    <div class="form-group">
                        <label for="valorMentoria">Valor total (R$)</label>
                        <input type="number" id="valorMentoria" placeholder="0,00" step="0.01" />
                    </div>
                    <div class="form-group">
                        <label for="formaPagamento">Forma de pagamento</label>
                        <input type="text" id="formaPagamento" placeholder="À vista / Parcelado em X vezes" />
                    </div>
                    <div class="form-group">
                        <label for="prazoMentoria">Duração / Prazo</label>
                        <input type="text" id="prazoMentoria" placeholder="Ex.: 6 meses de acompanhamento" />
                    </div>
                    <div class="form-group full-width">
                        <label for="observacoes">Observações adicionais</label>
                        <textarea id="observacoes" placeholder="Inclua cláusulas específicas, bônus, condições especiais, etc."></textarea>
                    </div>
                </div>

                <div class="btn-row">
                    <button type="button" class="btn-primary" onclick="gerarContrato()">Gerar contrato</button>
                    <button type="button" class="btn-secondary" onclick="printContract()">Imprimir / Salvar em PDF</button>
                </div>

                <p class="status" id="statusMensagem">Preencha os campos e clique em "Gerar contrato".</p>
            </article>

            <article class="contract" id="previewContrato">
                <h2>Contrato de Mentoria</h2>
                <p>Preencha os dados ao lado para visualizar o contrato aqui.</p>
            </article>
        </section>
    </main>

    <script>
        // ✅ VERIFICAÇÃO HÍBRIDA DE ADMIN
        (function validarAdmin() {
            const isAdminLocal = localStorage.getItem('admin') === 'true';
            const userType = sessionStorage.getItem('userType');

            if (!(isAdminLocal || userType === 'admin')) {
                alert('⚠️ Acesso negado. Apenas administradores podem gerar contratos.');
                window.location.replace('auth_system.html');
            }
        })();

        // Carrega dados do mentorado, se tiver vindo de outra tela (mock)
        const mentoradoJson = sessionStorage.getItem('currentMentorado');
        let mentorado = null;

        if (mentoradoJson) {
            try {
                mentorado = JSON.parse(mentoradoJson);
            } catch (e) {
                console.warn('Erro ao ler currentMentorado do sessionStorage:', e);
            }
        }

        if (mentorado) {
            document.getElementById('nomeMentorado').value   = mentorado.nome || '';
            document.getElementById('cpfMentorado').value    = mentorado.cpf || '';
            document.getElementById('cidadeMentorado').value = mentorado.cidade || '';
            document.getElementById('nomeMentoria').value    = mentorado.mentoria || '';
            document.getElementById('valorMentoria').value   = mentorado.valor || '';
        }

        function formatarDataBR(date) {
            if (!date) return '';
            const d = new Date(date);
            if (isNaN(d.getTime())) return date;
            const dia = String(d.getDate()).padStart(2, '0');
            const mes = String(d.getMonth() + 1).padStart(2, '0');
            const ano = d.getFullYear();
            return `${dia}/${mes}/${ano}`;
        }

        function gerarContrato() {
            const nome      = document.getElementById('nomeMentorado').value.trim();
            const cpf       = document.getElementById('cpfMentorado').value.trim();
            const cidadeUF  = document.getElementById('cidadeMentorado').value.trim();
            const data      = document.getElementById('dataContrato').value;
            const mentoria  = document.getElementById('nomeMentoria').value.trim();
            const valor     = document.getElementById('valorMentoria').value.trim();
            const forma     = document.getElementById('formaPagamento').value.trim();
            const prazo     = document.getElementById('prazoMentoria').value.trim();
            const obs       = document.getElementById('observacoes').value.trim();

            if (!nome || !cpf || !cidadeUF || !data || !mentoria || !valor || !forma || !prazo) {
                document.getElementById('statusMensagem').textContent =
                    'Preencha todos os campos principais para gerar o contrato.';
                return;
            }

            const dataBR = formatarDataBR(data);
            const hoje = new Date();
            const hojeBR = formatarDataBR(hoje.toISOString().substring(0,10));

            const contratoHTML = `
                <h2>Contrato de Prestação de Serviços de Mentoria</h2>
                <p><strong>CONTRATANTE:</strong> ${nome}, CPF nº ${cpf}, residente em ${cidadeUF}.</p>
                <p><strong>CONTRATADO:</strong> Instituto Tanigawa, doravante denominado simplesmente CONTRATADO.</p>
                <p><strong>OBJETO:</strong> O presente contrato tem por objeto a prestação de serviços de mentoria, no programa <strong>${mentoria}</strong>, com foco em desenvolvimento pessoal, espiritual e estratégico.</p>
                
                <h3>Cláusula 1ª – Do Prazo e Formato</h3>
                <p>A mentoria terá duração de <strong>${prazo}</strong>, com encontros e atividades conforme cronograma definido entre as partes.</p>

                <h3>Cláusula 2ª – Do Investimento e Forma de Pagamento</h3>
                <p>O valor total do investimento é de <strong>R$ ${valor}</strong>, com a seguinte forma de pagamento: <strong>${forma}</strong>.</p>

                <h3>Cláusula 3ª – Das Responsabilidades</h3>
                <p>O CONTRATADO se compromete a entregar os conteúdos, encontros e materiais propostos na mentoria, dentro de sua metodologia própria e agenda acordada.</p>
                <p>O CONTRATANTE é responsável por comparecer aos encontros, aplicar os conteúdos e honrar pontualmente os pagamentos assumidos.</p>

                <h3>Cláusula 4ª – Da Reagendamento e Cancelamento</h3>
                <p>Pedidos de reagendamento deverão ser feitos com antecedência mínima de 24 (vinte e quatro) horas. Em caso de cancelamento após o início da mentoria, poderão ser aplicadas taxas ou retenções proporcionais aos encontros já realizados.</p>

                <h3>Cláusula 5ª – Da Confidencialidade</h3>
                <p>Ambas as partes se comprometem a manter sigilo sobre informações estratégicas, pessoais e sensíveis compartilhadas durante a mentoria.</p>

                <h3>Cláusula 6ª – Das Considerações Finais</h3>
                <p>Este contrato entra em vigor na data de sua assinatura eletrônica ou física, prevalecendo a boa-fé, a transparência e o propósito de crescimento mútuo.</p>

                ${obs ? `<h3>Cláusula 7ª – Observações Específicas</h3><p>${obs}</p>` : ''}

                <div class="signature">
                    <p>${cidadeUF}, ${dataBR}.</p>
                    <hr />
                    <p><strong>${nome}</strong><br/>CONTRATANTE</p>
                    <hr />
                    <p><strong>Instituto Tanigawa</strong><br/>CONTRATADO</p>
                    <p style="margin-top:1rem;font-size:0.8rem;color:#6b7280;">
                        Documento gerado em ${hojeBR} via painel administrativo do Instituto Tanigawa.
                    </p>
                </div>
            `;

            const preview = document.getElementById('previewContrato');
            preview.innerHTML = contratoHTML;
            document.getElementById('statusMensagem').textContent =
                'Contrato gerado com sucesso. Revise o conteúdo antes de imprimir ou salvar em PDF.';
        }

        function printContract() {
            window.print();
        }

        function goBack() {
            window.location.href = 'admin_dashboard.html';
        }
    </script>
</body>
</html>
