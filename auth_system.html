<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login • Instituto Tanigawa</title>

    <style>
        :root {
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-tertiary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-quaternary: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);

            --color-dark: #0a0e27;
            --color-darker: #060919;
            --color-card: rgba(255, 255, 255, 0.03);
            --color-card-hover: rgba(255, 255, 255, 0.06);
            --color-text: #ffffff;
            --color-text-muted: #a0aec0;

            --shadow-card: 0 20px 60px rgba(0, 0, 0, 0.3);
            --shadow-glow: 0 0 40px rgba(102, 126, 234, 0.3);

            --radius-card: 24px;
            --radius-button: 50px;
        }

        body {
            margin: 0;
            font-family: "Inter", sans-serif;
            background: var(--color-dark);
            color: var(--color-text);
            overflow-x: hidden;
            background-image:
                radial-gradient(circle at 20% 50%, rgba(102,126,234,0.12) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(245,87,108,0.12) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(67,233,123,0.10) 0%, transparent 50%);
            animation: bgMove 25s infinite alternate ease-in-out;
        }

        @keyframes bgMove {
            from { background-position: 0 0; }
            to { background-position: 50px 80px; }
        }

        .container {
            max-width: 420px;
            margin: 100px auto;
            padding: 40px;
            background: var(--color-card);
            backdrop-filter: blur(16px);
            border-radius: var(--radius-card);
            border: 1px solid rgba(255,255,255,0.06);
            box-shadow: var(--shadow-card);
            animation: fadeInUp 0.8s ease;
            text-align: center;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            font-family: "Sora", sans-serif;
            font-size: 2.4rem;
            margin-bottom: 10px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-size: 1rem;
            color: var(--color-text-muted);
            margin-bottom: 30px;
        }

        .input-group {
            text-align: left;
            margin-bottom: 25px;
        }

        label {
            font-size: 0.9rem;
            color: var(--color-text-muted);
        }

        input {
            width: 100%;
            padding: 14px 18px;
            margin-top: 8px;
            border-radius: var(--radius-button);
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.04);
            color: var(--color-text);
            font-size: 1rem;
        }

        .mode-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        .mode-toggle button {
            width: auto;
            padding: 8px 16px;
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,0.2);
            background: transparent;
            font-family: "Inter", sans-serif;
            font-size: 0.9rem;
            box-shadow: none;
        }

        .mode-toggle button.active {
            background: var(--gradient-primary);
            box-shadow: 0 4px 15px rgba(102,126,234,0.5);
        }

        .main-button {
            width: 100%;
            padding: 14px;
            border-radius: var(--radius-button);
            background: var(--gradient-tertiary);
            font-family: "Sora", sans-serif;
            font-weight: 600;
            font-size: 1rem;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-top: 10px;
            transition: 0.3s;
            box-shadow: 0 4px 15px rgba(79,172,254,0.35);
        }

        .main-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(79,172,254,0.5);
        }

        .error-message {
            margin-top: 20px;
            color: #ff6b6b;
            font-size: 0.9rem;
            min-height: 20px;
        }
    </style>

    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;600;700;800&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <h1>Acesso</h1>
        <p class="subtitle">Painel administrativo • Instituto Tanigawa</p>

        <div class="mode-toggle">
            <button id="modeMember" class="active" type="button">Sou Membro</button>
            <button id="modeAdmin" type="button">Sou Admin</button>
        </div>

        <div class="input-group" id="emailGroup">
            <label for="email">E-mail</label>
            <input id="email" type="email" placeholder="Digite seu e-mail" required />
        </div>

        <div class="input-group">
            <label for="password">Senha</label>
            <input id="password" type="password" placeholder="Digite sua senha" required />
        </div>

        <button id="loginBtn" class="main-button">Entrar</button>

        <div class="error-message" id="error"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAk2XTgQ77gGs4gIJMLvINPs-t3ZHp4duY",
            authDomain: "instituto-tanigawa.firebaseapp.com",
            projectId: "instituto-tanigawa",
            storageBucket: "instituto-tanigawa.appspot.com",
            messagingSenderId: "189968630353",
            appId: "1:189968630353:web:d415d91ef913f4f789e8b5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const modeMemberBtn = document.getElementById("modeMember");
        const modeAdminBtn = document.getElementById("modeAdmin");
        const emailGroup = document.getElementById("emailGroup");
        const emailInput = document.getElementById("email");
        const passwordInput = document.getElementById("password");
        const errorDiv = document.getElementById("error");
        const loginBtn = document.getElementById("loginBtn");

        let currentMode = "member"; // "member" ou "admin"

        function setMode(mode) {
            currentMode = mode;
            errorDiv.textContent = "";

            if (mode === "member") {
                modeMemberBtn.classList.add("active");
                modeAdminBtn.classList.remove("active");
                emailGroup.style.display = "block";
                emailInput.required = true;
            } else {
                modeAdminBtn.classList.add("active");
                modeMemberBtn.classList.remove("active");
                emailGroup.style.display = "none";
                emailInput.required = false;
                emailInput.value = "";
            }
        }

        modeMemberBtn.addEventListener("click", () => setMode("member"));
        modeAdminBtn.addEventListener("click", () => setMode("admin"));

        async function sha256(text) {
            const encoder = new TextEncoder();
            const data = encoder.encode(text);
            const hashBuffer = await crypto.subtle.digest("SHA-256", data);
            return Array.from(new Uint8Array(hashBuffer))
                .map((b) => b.toString(16).padStart(2, "0"))
                .join("");
        }

        loginBtn.addEventListener("click", async () => {
            const email = emailInput.value.trim();
            const senha = passwordInput.value.trim();
            errorDiv.textContent = "";

            if (!senha) {
                errorDiv.textContent = "Digite a senha.";
                return;
            }

            try {
                if (currentMode === "admin") {
                    const hash = await sha256(senha);

                    // HASH CORRETO — SENHA: Sw04012014!&#
                    if (hash === "d17a1d2ab6c8efe744019a3249928591d70905d4c3ce309461634a3cf30cca9a") {
                        localStorage.setItem("admin", "true");
                        window.location.href = "admin_dashboard.html";
                        return;
                    }

                    errorDiv.textContent = "Senha administrativa incorreta.";
                    return;
                }

                // MODO MEMBRO — Firebase Auth
                if (!email) {
                    errorDiv.textContent = "Digite o e-mail.";
                    return;
                }

                await signInWithEmailAndPassword(auth, email, senha);
                localStorage.setItem("user", email);
                window.location.href = "area_membros.html";

            } catch (err) {
                errorDiv.textContent = "Credenciais inválidas. Verifique e tente novamente.";
            }
        });

        // Modo padrão ao carregar
        setMode("member");
    </script>
</body>
</html>
