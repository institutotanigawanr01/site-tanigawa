<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Acesso ‚Ä¢ Instituto Tanigawa</title>
  <meta name="description" content="√Årea restrita para membros e administradores do Instituto Tanigawa.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-tertiary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --color-dark: #0a0e27;
      --color-card: rgba(255,255,255,0.04);
      --color-card-strong: rgba(10,14,39,0.95);
      --color-text: #ffffff;
      --color-text-muted: #a0aec0;
      --danger: #f5576c;
      --shadow-card: 0 20px 60px rgba(0,0,0,0.6);
      --shadow-glow: 0 0 40px rgba(102,126,234,0.45);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--color-text);
      background: var(--color-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px 16px;
      background-image:
        radial-gradient(circle at 20% 50%, rgba(102,126,234,0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(245,87,108,0.12) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(67,233,123,0.10) 0%, transparent 50%);
      animation: bgMove 25s infinite alternate ease-in-out;
    }

    @keyframes bgMove {
      from { background-position: 0 0; }
      to   { background-position: 40px 80px; }
    }

    .card {
      width: 100%;
      max-width: 420px;
      background: var(--color-card-strong);
      border-radius: 24px;
      padding: 32px 28px 28px;
      border: 1px solid rgba(255,255,255,0.06);
      box-shadow: var(--shadow-card);
      backdrop-filter: blur(16px);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top left, rgba(102,126,234,0.35), transparent 55%);
      opacity: 0.7;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 2;
    }

    h1 {
      font-family: "Sora", system-ui, sans-serif;
      font-size: 2.4rem;
      margin-bottom: 4px;
      text-align: center;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .subtitle {
      text-align: center;
      font-size: 0.95rem;
      color: var(--color-text-muted);
      margin-bottom: 24px;
    }

    .mode-toggle {
      display: flex;
      gap: 8px;
      padding: 4px;
      border-radius: 999px;
      background: rgba(255,255,255,0.05);
      margin-bottom: 24px;
    }

    .mode-toggle button {
      flex: 1;
      border-radius: 999px;
      border: none;
      padding: 8px 0;
      font-size: 0.9rem;
      font-weight: 500;
      font-family: "Inter", system-ui, sans-serif;
      background: transparent;
      color: var(--color-text-muted);
      cursor: pointer;
      transition: 0.25s;
    }

    .mode-toggle button.active {
      background: var(--gradient-primary);
      color: #fff;
      box-shadow: 0 4px 14px rgba(102,126,234,0.7);
    }

    .form-group {
      margin-bottom: 18px;
    }

    label {
      display: block;
      font-size: 0.85rem;
      color: var(--color-text-muted);
      margin-bottom: 6px;
    }

    input {
      width: 100%;
      padding: 13px 16px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(6,9,25,0.95);
      color: var(--color-text);
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.25s, box-shadow 0.25s, background 0.25s;
    }

    input:focus {
      border-color: rgba(102,126,234,0.9);
      box-shadow: 0 0 0 1px rgba(102,126,234,0.6);
      background: rgba(4,7,20,0.98);
    }

    .main-button {
      margin-top: 4px;
      width: 100%;             /* mesma largura do input */
      padding: 13px 16px;      /* mesma altura base do input */
      border-radius: 999px;
      border: none;
      background: var(--gradient-tertiary);
      color: #fff;
      font-size: 1rem;
      font-weight: 600;
      font-family: "Sora", system-ui, sans-serif;
      cursor: pointer;
      box-shadow: 0 6px 22px rgba(79,172,254,0.65);
      transition: 0.25s;
    }

    .main-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 28px rgba(79,172,254,0.9);
    }

    .helper {
      margin-top: 18px;
      font-size: 0.8rem;
      text-align: center;
      color: var(--color-text-muted);
    }

    .helper a {
      color: #4facfe;
      text-decoration: none;
    }

    .error {
      min-height: 18px;
      margin-top: 16px;
      font-size: 0.85rem;
      color: var(--danger);
      text-align: center;
    }

    .hint {
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--color-text-muted);
      text-align: center;
    }

/* Anima√ß√£o de shake para erros */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
      20%, 40%, 60%, 80% { transform: translateX(5px); }
    }

    .error.shake {
      animation: shake 0.5s;
    }

    @media (max-width: 480px) {
      .card {
        padding: 26px 18px 22px;
      }
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="card-inner">
      <h1>Acesso</h1>
      <p class="subtitle">Painel administrativo ‚Ä¢ Instituto Tanigawa</p>

      <div class="mode-toggle">
        <button id="btnMember" class="active" type="button">Sou Membro</button>
        <button id="btnAdmin" type="button">Sou Admin</button>
      </div>

      <div id="groupEmail" class="form-group">
        <label for="email">E-mail</label>
        <input id="email" type="email" placeholder="digite seu e-mail" autocomplete="email" />
      </div>

      <div class="form-group">
        <label for="password">Senha</label>
        <input id="password" type="password" placeholder="digite sua senha" autocomplete="current-password" />
      </div>

      <button id="btnLogin" class="main-button" type="button">Entrar</button>

      <div id="error" class="error"></div>
      <p class="hint">Pressione Enter para acessar mais r√°pido.</p>

      <p class="helper">
        Ainda n√£o fez o cadastro completo?<br />
        <a href="cadastro-completo.html">Clique aqui para iniciar sua jornada.</a>
      </p>
    </div>
  </div>

  <script>
    const btnMember = document.getElementById("btnMember");
    const btnAdmin  = document.getElementById("btnAdmin");
    const groupEmail = document.getElementById("groupEmail");
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const btnLogin = document.getElementById("btnLogin");
    const errorBox = document.getElementById("error");

    let currentMode = "member"; // "member" ou "admin"

    function setMode(mode) {
      currentMode = mode;
      errorBox.textContent = "";

      if (mode === "member") {
        btnMember.classList.add("active");
        btnAdmin.classList.remove("active");
        groupEmail.style.display = "block";
      } else {
        btnAdmin.classList.add("active");
        btnMember.classList.remove("active");
        groupEmail.style.display = "none";
        emailInput.value = "";
      }
    }

    btnMember.addEventListener("click", () => setMode("member"));
    btnAdmin.addEventListener("click", () => setMode("admin"));

/*
     * ============================================
     * NOTA DE SEGURAN√áA - SHA-256 HASHING
     * ============================================
     * 
     * O hash SHA-256 √© calculado no cliente (navegador) e enviado
     * para /api/auth que valida contra keys.json armazenado em 
     * ENV variables do Vercel.
     * 
     * A senha NUNCA √© enviada em texto plano pela rede.
     * 
     * Hash correto para admin:
     * d17a1d2ab6c8efe744019a3249928591d70905d4c3ce309461634a3cf30cca9a
     * 
     * Senha original (apenas para refer√™ncia de desenvolvimento):
     * Sw04012014!&#
     * 
     * EM PRODU√á√ÉO: keys.json deve estar APENAS em ENV variables,
     * NUNCA commitado no reposit√≥rio Git.
     * ============================================
     */

    async function sha256(text) {
      const encoder = new TextEncoder();
      const data = encoder.encode(text);
      const hashBuffer = await crypto.subtle.digest("SHA-256", data);
      return Array.from(new Uint8Array(hashBuffer))
        .map(b => b.toString(16).padStart(2, "0"))
        .join("");
    }

    async function handleLogin() {
      errorBox.textContent = "";

      const senha = passwordInput.value.trim();

      if (!senha) {
        errorBox.textContent = "Digite a senha.";
        return;
      }

      if (currentMode === "admin") {
        // üîê ADMIN VIA HASH (keys.json)
        const hash = await sha256(senha);

        // Hash correto da senha Sw04012014!&#
        const ADMIN_HASH = "d17a1d2ab6c8efe744019a3249928591d70905d4c3ce309461634a3cf30cca9a";

        if (hash === ADMIN_HASH) {
          // Mant√©m sess√£o em todo o site
          localStorage.setItem("admin", "true");
          sessionStorage.setItem("userType", "admin");
          sessionStorage.setItem("userName", "Sergio Tanigawa");
          sessionStorage.setItem("userEmail", "admin@institutotanigawa.com.br");

          window.location.href = "admin_dashboard.html";
          return;
        } else {
          errorBox.textContent = "Senha administrativa incorreta.";
          return;
        }
      }

      // üîì MODO MEMBRO ‚Äì por enquanto s√≥ placeholder
      const email = (emailInput.value || "").trim();

      if (!email) {
        errorBox.textContent = "Digite o e-mail para entrar como membro.";
        return;
      }

      // Aqui no futuro entrar√° o Firebase Auth / outro sistema.
      // Por enquanto, apenas mensagem amig√°vel.
      errorBox.textContent = "üîí Login de membros em desenvolvimento. Entre em contato com tanigawa.sergio@gmail.com para ativar seu acesso.";
      errorBox.classList.add('shake');
      setTimeout(() => errorBox.classList.remove('shake'), 500);
    }
} finally {
        // Restaura bot√£o
        btnLogin.textContent = originalText;
        btnLogin.disabled = false;
      }
    }
    btnLogin.addEventListener("click", handleLogin);

    // ENTER na senha = clicar no bot√£o
    passwordInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        handleLogin();
      }
    });

    // ENTER no campo de e-mail tamb√©m dispara se estiver em modo membro
    emailInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter" && currentMode === "member") {
        event.preventDefault();
        handleLogin();
      }
    });

    // Modo padr√£o ao carregar
    setMode("admin"); // se preferir come√ßar em "member", troque aqui
  </script>
</body>
</html>

