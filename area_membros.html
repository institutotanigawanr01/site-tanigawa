<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årea de Membros - Instituto Tanigawa</title>
    <meta name="description" content="√Årea exclusiva para membros do Instituto Tanigawa. Acesse suas mentorias, v√≠deo aulas e conte√∫dos exclusivos.">
    
    <!-- Fontes do Design System (Sora para T√≠tulos, Inter para Corpo) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- FIREBASE IMPORTS CR√çTICOS (Autentica√ß√£o) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        // Vari√°veis globais do Canvas (CR√çTICO para a inicializa√ß√£o)
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const app = initializeApp(firebaseConfig);
        window.auth = getAuth(app); 
        
        // O restante do c√≥digo JS ser√° executado fora deste m√≥dulo
    </script>
    
    <style>
        /* VARI√ÅVEIS DO DESIGN SYSTEM (COMPLETO) */
        :root {
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-tertiary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-quaternary: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            
            --color-dark: #0a0e27;
            --color-darker: #060919;
            --color-card: rgba(255, 255, 255, 0.03);
            --color-card-hover: rgba(255, 255, 255, 0.06);
            --color-text: #ffffff;
            --color-text-muted: #a0aec0;
            --color-accent: #667eea;
            --shadow-card: 0 20px 60px rgba(0, 0, 0, 0.3);
            
            --section-padding: 3rem;
            --container-max-width: 1400px;
        }

        /* CONVERS√ÉO EST√âTICA COMPLETA */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--color-darker);
            color: var(--color-text);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
            padding-top: 80px; /* Espa√ßo para o header fixo */
        }
        
        /* üåä EFEITOS VISUAIS DE FUNDO (Fidelidade Est√©tica) */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(245, 87, 108, 0.1) 0%, transparent 50%);
            z-index: 0;
            animation: backgroundShift 20s ease infinite;
            pointer-events: none;
        }

        @keyframes backgroundShift {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        .floating-particle {
            position: fixed;
            width: 4px;
            height: 4px;
            background: rgba(102, 126, 234, 0.6); 
            border-radius: 50%;
            pointer-events: none;
            z-index: 0;
            animation: float 20s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-30px) translateX(20px); }
            50% { transform: translateY(-60px) translateX(-20px); }
            75% { transform: translateY(-30px) translateX(10px); }
        }
        
        /* HEADER (Simplificado para √°rea interna) */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(10, 14, 39, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-family: 'Sora', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-decoration: none;
        }

        .user-header {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .user-header span {
            font-size: 0.95rem;
            color: var(--color-text-muted);
        }

        .logout-btn {
            background: var(--gradient-secondary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(245, 87, 108, 0.3);
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(245, 87, 108, 0.5);
        }
        
        /* DASHBOARD LAYOUT */
        main {
            position: relative;
            z-index: 1;
            display: flex;
            max-width: var(--container-max-width);
            margin: 0 auto;
            padding: var(--section-padding) 2rem;
            gap: 2rem;
        }
        
        .sidebar {
            width: 300px;
            min-width: 250px;
            padding: 1.5rem;
            background: var(--color-card);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            height: fit-content;
        }

        .content-area {
            flex-grow: 1;
        }
        
        .welcome-box {
            background: var(--gradient-primary);
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            color: white;
        }
        
        .welcome-box h2 {
            font-family: 'Sora', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }
        
        .welcome-box p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* CARDS DE CONTE√öDO */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .mentoria-card {
            background: var(--color-card);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--color-text);
            position: relative;
            overflow: hidden;
            border-left: 5px solid;
        }
        
        .mentoria-card:hover {
            background: var(--color-card-hover);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .mentoria-card h3 {
            font-family: 'Sora', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .mentoria-card p {
            font-size: 0.9rem;
            color: var(--color-text-muted);
        }
        
        .mentoria-card .access-btn {
            display: block;
            margin-top: 1rem;
            background: var(--gradient-primary);
            color: white;
            padding: 0.6rem;
            text-align: center;
            border-radius: 50px;
            font-weight: 600;
        }
        
        /* Estilos de Cores Din√¢micas */
        .mentoria-card[data-type="LEV"] { border-left-color: var(--color-accent-secondary); }
        .mentoria-card[data-type="SYNESIS"] { border-left-color: var(--color-accent); }
        
        /* Estilos do Sidebar */
        .sidebar h3 {
            font-family: 'Sora', sans-serif;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            padding-bottom: 0.5rem;
        }
        
        .sidebar-item {
            display: block;
            color: var(--color-text-muted);
            text-decoration: none;
            padding: 0.75rem 0;
            border-left: 3px solid transparent;
            padding-left: 10px;
            transition: all 0.3s ease;
        }
        
        .sidebar-item:hover, .sidebar-item.active {
            color: var(--color-text);
            border-left: 3px solid var(--color-accent);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        @media (max-width: 1024px) {
            main {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>

    <header>
        <a href="home.html" class="logo">INSTITUTO TANIGAWA</a>
        <div class="user-header">
            <span>Ol√°, <b id="headerNome">Membro</b>!</span>
            <button class="logout-btn" onclick="logout()">Sair</button>
        </div>
    </header>

    <main>
        <aside class="sidebar">
            <h3>Navega√ß√£o</h3>
            <a href="area_membros.html" class="sidebar-item active">üè† Dashboard</a>
            <a href="plataforma_aulas.html" class="sidebar-item">üìö Minhas Aulas</a>
            <a href="perfil.html" class="sidebar-item">üë§ Meu Perfil</a>
            <a href="contato.html" class="sidebar-item">üìû Suporte</a>
            
            <h3 style="margin-top: 2rem;">Status</h3>
            <p style="font-size: 0.9rem; color: var(--color-text);">
                Tipo de Conta: <strong id="accountType">Membro</strong>
            </p>
            <p style="font-size: 0.9rem; color: var(--color-text-muted); margin-top: 0.5rem;">
                Mentoria Ativa: <strong id="mentoriaAtiva">Carregando...</strong>
            </p>
            
        </aside>
        
        <div class="content-area">
            <div class="welcome-box">
                <h2 id="welcomeNome">Ol√°, Membro!</h2>
                <p id="welcomeMentoria">Prepare-se para uma jornada de transforma√ß√£o profunda.</p>
            </div>
            
            <h3>Seu Conte√∫do Exclusivo</h3>
            
            <div class="content-grid" id="mentoriaContentGrid">
                <!-- Cards de Mentoria/Conte√∫do Injetados Aqui -->
            </div>

            <div style="margin-top: 3rem; padding: 1.5rem; background: var(--color-card); backdrop-filter: blur(10px); border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.05);">
                <h3 style="margin-bottom: 1rem; color: var(--color-accent);">Pr√≥ximos Passos</h3>
                <p style="color: var(--color-text-muted);">
                    Se esta √© sua primeira vez aqui, comece acessando o link <a href="plataforma_aulas.html" style="color: var(--color-accent);">"Minhas Aulas"</a> no menu lateral para iniciar seu m√≥dulo de Mentoria.
                </p>
            </div>
        </div>
    </main>

    <script type="module">
        // Imports j√° definidos no bloco <script type="module"> inicial
        import { signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";


        /* ----------------------------------------------------
           FUN√á√ïES DE LAYOUT E FIREBASE
           ---------------------------------------------------- */
           
        // Inicia DB fora do m√≥dulo
        let db; 
        if (window.auth) {
            db = getFirestore(window.auth.app);
        }

        // üõë FUN√á√ÉO CR√çTICA DE AUTENTICA√á√ÉO (Guard-Rail)
        function checkAuth() {
            // Se o Firebase ainda n√£o carregou, espera
            if (!window.auth) {
                 setTimeout(checkAuth, 100); 
                 return;
            }

            // Listener de estado de autentica√ß√£o
            onAuthStateChanged(window.auth, (user) => {
                if (!user) {
                    // N√£o logado: Redireciona para login
                    window.location.replace('auth_system.html');
                    return;
                }
                
                // Logado: Carrega dados do sessionStorage (definidos no auth_system.html)
                const userType = sessionStorage.getItem('userType');
                const userName = sessionStorage.getItem('userName');
                const userEmail = sessionStorage.getItem('userEmail');
                const userMentoria = sessionStorage.getItem('userMentoria'); // Pr√≥xima etapa (ser√° din√¢mico)
                
                // üõë GUARD-RAIL: Se for Admin, redireciona para o Painel Admin
                if (userType === 'admin') {
                    window.location.replace('admin_dashboard.html');
                    return;
                }
                
                // 1. Preenche a interface
                const nomeCompleto = userName || userEmail.split('@')[0];
                const mentoriaAtual = userMentoria || 'Acesso Geral';

                document.getElementById('headerNome').textContent = nomeCompleto;
                document.getElementById('welcomeNome').textContent = 'Ol√°, ' + nomeCompleto.split(' ')[0] + '!';
                document.getElementById('accountType').textContent = 'Membro';
                document.getElementById('mentoriaAtiva').textContent = mentoriaAtual;
                
                if (mentoriaAtual !== 'Acesso Geral') {
                    document.getElementById('welcomeMentoria').textContent = `Voc√™ est√° na Mentoria ${mentoriaAtual}. Continue sua jornada de transforma√ß√£o!`;
                }

                // 2. Carrega o conte√∫do din√¢mico (mentorias/produtos)
                carregarConteudoDinamico(mentoriaAtual);

            });
        }
        
        // Fun√ß√£o de Logout (Firebase)
        window.logout = async function() {
            try {
                await signOut(window.auth);
                sessionStorage.clear();
                window.location.replace('auth_system.html');
            } catch (error) {
                console.error("Erro ao fazer logout:", error);
                // Mesmo com erro, tenta limpar e redirecionar
                sessionStorage.clear();
                window.location.replace('auth_system.html');
            }
        };

        // Carrega as part√≠culas (Fidelidade Est√©tica)
        function createFloatingParticles() {
            const particleCount = 30;
            const container = document.body;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'floating-particle';
                
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                
                particle.style.animationDuration = (Math.random() * 20 + 10) + 's';
                particle.style.animationDelay = (Math.random() * 5) + 's';
                container.appendChild(particle);
            }
        }
        
        // üõë CARREGAMENTO DIN√ÇMICO DE CONTE√öDO (MOCK UP - Pr√≥xima Fase ser√° o Real)
        function carregarConteudoDinamico(mentoria) {
            const grid = document.getElementById('mentoriaContentGrid');
            grid.innerHTML = '';
            
            // MOCK DATA (Simulando o que viria do Firestore)
            const mockProducts = [
                { nome: 'Mentoria SYNESIS', tipo: 'Mentoria', descricao: 'Seu ponto de partida para a transforma√ß√£o espiritual.', link: 'plataforma_aulas.html', gradient: 'primary' },
                { nome: 'Ebook: O Poder da Cura', tipo: 'Ebook', descricao: 'Um guia pr√°tico para a cura emocional e espiritual.', link: 'ebook-download.html', gradient: 'secondary' },
                { nome: 'Imers√£o LEV', tipo: 'Imers√£o', descricao: 'Treinamento intensivo de dois dias sobre liberdade emocional.', link: 'imersao-inscricao.html', gradient: 'secondary' }
            ];

            mockProducts.forEach(p => {
                // Apenas exibe o card se for a mentoria ativa (MOCK UP)
                if (p.nome.includes(mentoria) || mentoria === 'Acesso Geral' || p.tipo !== 'Mentoria') {
                    const card = document.createElement('a');
                    card.href = p.link;
                    card.className = 'mentoria-card';
                    card.setAttribute('data-type', p.nome.split(' ')[1] || p.tipo);
                    card.style.borderLeftColor = `var(--color-accent)`; // Simplificado para fins de mock

                    card.innerHTML = `
                        <h3 style="background: var(--gradient-${p.gradient}); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${p.nome}</h3>
                        <p>${p.descricao}</p>
                        <span class="access-btn">Acessar ${p.tipo} ‚Üí</span>
                    `;
                    grid.appendChild(card);
                }
            });

            if (grid.children.length === 0) {
                 grid.innerHTML = `<p style="color: var(--color-text-muted);">Nenhum conte√∫do liberado para sua conta ainda.</p>`;
            }
        }


        // ----------------------------------------------------
        // INICIALIZA√á√ÉO
        // ----------------------------------------------------

        document.addEventListener('DOMContentLoaded', function() {
            createFloatingParticles();
            checkAuth(); // Inicia a verifica√ß√£o de seguran√ßa
        });
        
    </script>
</body>
</html>